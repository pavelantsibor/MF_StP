<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор MultiFRAME</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <img src="logo.png" alt="Логотип" class="brand-logo" />
            <h1>Калькулятор MultiFRAME</h1>
            <p class="subtitle">Расчёт и визуализация схем монтажа на потолке</p>
        </header>

        <div class="main-content">
            <div class="input-panel">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h2 style="margin: 0;">Площадь потолка</h2>
                        <div class="theme-toggle">
                            <label class="theme-switch" title="Переключить тему">
                                <input type="checkbox" id="themeSwitch" aria-label="Переключатель темы">
                                <span class="switch-track">
                                    <span class="icon-sun" aria-hidden="true"></span>
                                    <span class="icon-moon" aria-hidden="true"></span>
                                    <span class="switch-thumb"></span>
                                </span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="mainLength" title="Минимальное значение: 0.1 м, максимальное: 100 м">
                            Длина помещения (м):
                        </label>
                        <input type="number" id="mainLength" value="5.00" step="0.01" min="0.1" max="100" required>
                        <span class="error-message" id="mainLengthError"></span>
                    </div>
                    <div class="form-group">
                        <label for="mainWidth" title="Минимальное значение: 0.1 м, максимальное: 100 м">
                            Ширина помещения (м):
                        </label>
                        <input type="number" id="mainWidth" value="5.00" step="0.01" min="0.1" max="100" required>
                        <span class="error-message" id="mainWidthError"></span>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="hasLeg" checked>
                            Г-образное помещение (с выступом)
                        </label>
                    </div>
                    <div id="legFields" class="leg-fields" style="display: block;">
                        <div class="form-group">
                            <label for="legLength" title="Минимальное значение: 0.1 м, максимальное: 100 м">
                                Длина выступа (м):
                            </label>
                            <input type="number" id="legLength" value="1.50" step="0.01" min="0.1" max="100" required>
                            <span class="error-message" id="legLengthError"></span>
                        </div>
                        <div class="form-group">
                            <label for="legWidth" title="Минимальное значение: 0.1 м, максимальное: 100 м">
                                Ширина выступа (м):
                            </label>
                            <input type="number" id="legWidth" value="2.00" step="0.01" min="0.1" max="100" required>
                            <span class="error-message" id="legWidthError"></span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Параметры панелей</h2>
                    <div class="form-group">
                        <label title="Размер панели учитывает эффективную площадь с учётом шип-паз соединения (0,735 × 0,535 м для расчёта)">
                            Размер панели:
                        </label>
                        <div class="static-field">0,75 м × 0,55 м</div>
                    </div>
                </div>

                <div class="card">
                    <h2>Стоимость</h2>
                    <div class="form-group">
                        <label for="pricePerM2" title="Введите стоимость одного квадратного метра панелей">
                            Стоимость за м² (руб):
                        </label>
                        <input type="number" id="pricePerM2" value="6000" step="1" min="0" max="1000000">
                        <span class="error-message" id="pricePerM2Error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="autoCalc">
                        Автоматический рассчёт
                    </label>
                </div>

                <button id="calculateBtn" class="btn btn-primary">
                    <span class="btn-icon" aria-hidden="true">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="3" width="7" height="7" rx="1" fill="currentColor"/>
                            <rect x="14" y="3" width="7" height="7" rx="1" fill="currentColor" opacity="0.8"/>
                            <rect x="3" y="14" width="7" height="7" rx="1" fill="currentColor" opacity="0.8"/>
                            <rect x="14" y="14" width="7" height="7" rx="1" fill="currentColor"/>
                        </svg>
                    </span>
                    Рассчитать
                </button>
            </div>

            <div class="visualization-panel">
                <div class="card">
                    <h2 id="selectedSchemeTitle">Схема монтажа</h2>

                    <div class="canvas-container">
                        <div class="canvas-wrapper" id="bestScheme">
                            <canvas id="canvas1"></canvas>
                            <div class="canvas-controls">
                                <button class="icon-btn" title="Увеличить" style="font-weight:700;" onclick="zoomCanvas('bestScheme', 1.2)">+</button>
                                <button class="icon-btn" title="Уменьшить" style="font-weight:700;" onclick="zoomCanvas('bestScheme', 0.8)">-</button>
                                <label class="canvas-checkbox">
                                    <input type="checkbox" id="showGrid" checked>
                                    Сетка
                                </label>
                                <label class="canvas-checkbox">
                                    <input type="checkbox" id="showNumbers" checked>
                                    Номера
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="stats-panel">
                        <div class="stat-card">
                            <div class="stat-label">Всего панелей (с запасом)</div>
                            <div class="stat-value" id="totalPanels">0 шт.</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Площадь покрытия</div>
                            <div class="stat-value" id="coverageArea">0 м²</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Общая стоимость материалов</div>
                            <div class="stat-value" id="totalCost">0 ₽</div>
                        </div>
                        <div class="stat-card-button">
                            <button class="btn-print" onclick="saveToPDF()">
                                <svg class="btn-print-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 9L12 14L17 9" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M7 14L12 19L17 14" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                СКАЧАТЬ РАСЧЁТ
                            </button>
                        </div>
                    </div>

                    <div class="card" style="margin-top:16px;">
                        <h2>Результаты расчета</h2>
                        <div id="resultsText" style="white-space:pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size:13px; color: var(--text-primary);"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="calculator.js"></script>
    <script src="visualizer.js"></script>
    <script src="app.js"></script>
</body>
</html>

